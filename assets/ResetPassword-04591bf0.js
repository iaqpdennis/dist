import{k as D,l as U,r as c,c as g,m as j,d as e,e as m,f as r,i as _,p as i,T as z,q as G,h as a,G as b,t as u,v as k,x as f,y as H,H as J,F as C,I as K,A as x,B as Y,z as $,j as O,J as Q,C as I,K as W,E as X}from"./index-2cc77167.js";const Z=r("h2",{class:"text-2xl font-semibold text-slate-600 dark:text-navy-100"},"Reset Password",-1),ee=r("div",{class:"mt-2"},[r("p",{class:"text-slate-400 dark:text-navy-300"}," Recover your account by resetting your password securely. ")],-1),se={class:"mt-8"},ae={key:0,class:"list-disc px-4"},re={key:1},oe=["onSubmit"],le={__name:"ResetPassword",setup(te){const A=O(),V=Q(),T=D(),o=U({password:{new:"",confirm:""}}),t=c(!1),w=c(!1),p=c(!1),d=c(""),v=c(5);let y,h;const q=g(()=>!!Array.isArray(d.value)),P=g(()=>({hash:A.query.hash,new_password:o.password.new,new_password_confirmation:o.password.confirm})),E=g(()=>({password:{new:{required:I},confirm:{required:I,sameAs:W(o.password.new)}}})),s=j(E,o);async function L(){if(await s.value.$validate())try{clearTimeout(y),t.value=!0,p.value=!1,await T.resetPassword(P.value),t.value=!1,w.value=!0,R(),S()}catch(n){t.value=!1,p.value=!0,d.value=n,N()}}function N(){y=setTimeout(()=>{p.value=!1,d.value=""},5e3)}function R(){y=setTimeout(()=>{w.value=!1,V.push("/login")},5e3)}function S(){h=setInterval(()=>{if(v.value--,v.value===0){clearInterval(h);return}},1e3)}function B(){clearInterval(h),v.value=5,w.value=!1,V.push("/login")}return(M,n)=>{const F=X("Icon");return e(),m(C,null,[Z,ee,r("div",se,[_(z,{name:"fade"},{default:i(()=>[p.value?(e(),u(Y,{key:0,mode:"error",class:"mb-5"},{default:i(()=>[a(q)?(e(),m("ul",ae,[(e(!0),m(C,null,K(d.value,l=>(e(),m("li",{key:l},x(l),1))),128))])):(e(),m("span",re,x(d.value.message),1))]),_:1})):f("",!0)]),_:1}),r("form",{class:"space-y-6",onSubmit:G(L,["prevent"])},[r("div",null,[_(b,{modelValue:o.password.new,"onUpdate:modelValue":n[0]||(n[0]=l=>o.password.new=l),label:"New password",placeholder:"Enter your new password","is-invalid":a(s).password.new.$error},null,8,["modelValue","is-invalid"]),a(s).password.new.$error&&a(s).password.new.required.$invalid?(e(),u(k,{key:0},{default:i(()=>[$(" New password is required. ")]),_:1})):f("",!0)]),r("div",null,[_(b,{modelValue:o.password.confirm,"onUpdate:modelValue":n[1]||(n[1]=l=>o.password.confirm=l),label:"Confirm new password",placeholder:"Re-type your new password","is-invalid":a(s).password.confirm.$error},null,8,["modelValue","is-invalid"]),a(s).password.confirm.$error&&a(s).password.confirm.required.$invalid?(e(),u(k,{key:0},{default:i(()=>[$(" Confirm password is required. ")]),_:1})):a(s).password.confirm.$error&&a(s).password.confirm.sameAs.$invalid?(e(),u(k,{key:1},{default:i(()=>[$(" Password does not match. ")]),_:1})):f("",!0)]),r("div",null,[_(H,{type:"submit",mode:"primary",disabled:t.value},{default:i(()=>[t.value?(e(),u(F,{key:0,icon:"gg:spinner",class:"animate-spin text-base"})):f("",!0),r("span",null,x(t.value?"Loading...":"Change Password"),1)]),_:1},8,["disabled"])])],40,oe)]),w.value?(e(),u(J,{key:0,title:"Password Changed!",message:"You will now be redirected to the login page.","confirm-text":`Login (${v.value})`,onConfirm:B},null,8,["confirm-text"])):f("",!0)],64)}}};export{le as default};
