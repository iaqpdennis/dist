import{Q as l,k as o,S as i,U as c,V as m,W as u}from"./index-2cc77167.js";const d=l("login",{actions:{async login(s){const e=o(),{AUTH_LOGIN_URL:n}=i(e.isMemberUser);try{const{data:{data:t,meta:a}}=await c.post(n,s);if(t!==null){e.loggedMember=e.encryptData(t),e.quickStart=a.quick_start,e.subscriptionPlan=e.encryptData(a.subscription_plan),e.firstLogin=a.first_login,e.setTokenToCookie(a);const r=this.checkIfHasDefaultHomePage(t);return!r||!(r!=null&&r.value)?!0:`/dashboard/department/${r.value}`}return e.memberCredentials=e.encryptData({email:s.email,remember_me:s.remember_me}),!1}catch({response:t}){if(t.status===401)throw new Error("Invalid email address or password.");if(t.status===403)throw m()._s.forEach(a=>a.$reset()),this.deleteTokenFromCookie(),new Error("Something went wrong. Please try again.");u(t)}},async verifyAuth(s){const e=o(),{AUTH_EMAIL_VERIFY_OTP_URL:n}=i(e.isMemberUser);try{const{data:{data:t,meta:a}}=await c.post(n,s);e.loggedMember=e.encryptData(t),e.quickStart=a.quick_start,e.subscriptionPlan=e.encryptData(a.subscription_plan),e.firstLogin=a.first_login,e.memberCredentials=null,e.setTokenToCookie(a);const r=this.checkIfHasDefaultHomePage(t);return!r||!(r!=null&&r.value)?!0:`/dashboard/department/${r.value}`}catch({response:t}){u(t)}},async sendEmailOTP(s){const e=o(),{AUTH_EMAIL_SEND_OTP_URL:n}=i(e.isMemberUser);try{await c.post(n,s)}catch({response:t}){u(t)}},checkIfHasDefaultHomePage(s){var n;return((n=s.settings)==null?void 0:n.find(({setting:t})=>t=="favorite-department"))??!1}}});export{d as u};
